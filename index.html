<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>TicketUI â€“ Correct OK Zoom Alignment</title>
<script src="https://cdn.tailwindcss.com"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, system-ui;
  }

  .color-input {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
  }
</style>
</head>

<body class="w-full min-h-screen bg-[#1797D0] flex items-center justify-center">

<!-- MASTER WRAPPER -->
<div id="master"
     class="relative w-[375px] h-[812px] origin-center"
     style="transform:scale(1);">

  <!-- BACKGROUND LAYER (fixed until OK) -->
  <div id="bgLayer"
       class="absolute inset-0"
       style="
         background-size: cover;
         background-position: center;
         background-repeat: no-repeat;
       ">
  </div>

  <!-- UI LAYER (moves before OK) -->
  <div id="uiLayer"
       class="absolute inset-0 origin-center"
       style="transform:scale(1);">

    <!-- QR RING -->
    <div id="qrRing"
      class="absolute"
      style="
        top:82px;
        left:50%;
        transform:translateX(-50%);
        width:169px;
        height:169px;
        border-radius:16px;
        border:13px solid;
        position:relative;
      ">
      <input type="color" class="color-input"
        onchange="setRingColor(this.value)" />
    </div>

    <!-- ZOOM + OK -->
    <div class="absolute"
      style="top:610px; left:50%; transform:translateX(-50%); width:270px;">
      
      <button id="okBtn"
        class="w-full mb-2 py-2 rounded bg-black text-white text-sm">
        OK (Lock Alignment)
      </button>

      <input id="zoomSlider"
        type="range" min="70" max="150" value="100" class="w-full" />

      <div class="text-xs text-center mt-1">
        Zoom: <span id="zoomVal">100%</span>
      </div>
    </div>

    <!-- COLOR BARS -->
    <div class="absolute flex"
      style="top:674px; left:50%; transform:translateX(-50%);
             width:278px; height:20px;">
      <div id="bar1" class="flex-1 relative">
        <input type="color" class="color-input"
          onchange="setBarColor(0,this.value)" />
      </div>
      <div id="bar2" class="flex-1 relative">
        <input type="color" class="color-input"
          onchange="setBarColor(1,this.value)" />
      </div>
      <div id="bar3" class="flex-1 relative">
        <input type="color" class="color-input"
          onchange="setBarColor(2,this.value)" />
      </div>
    </div>

    <!-- EXPIRY -->
    <h3 id="expiry"
      class="absolute w-full text-center cursor-pointer"
      style="top:727px; font-size:21px; font-weight:600;">
      Expires in 60:00
    </h3>

    <!-- NUMBER -->
    <h1 id="num"
      class="absolute w-full text-center cursor-pointer"
      style="top:309px; font-size:56px; font-weight:800;">
      2
    </h1>

  </div>
</div>

<script>
/* ================= STATE ================= */
let uiScale = 1;
let masterScale = 1;
let locked = false;

let ringColor = "#9CA3AF";
let barColors = ["#22C55E", "#EF4444", "#22C55E"];
let numVal = 2;

/* ================= ELEMENTS ================= */
const master = document.getElementById("master");
const bg = document.getElementById("bgLayer");
const ui = document.getElementById("uiLayer");
const ring = document.getElementById("qrRing");
const bars = [
  document.getElementById("bar1"),
  document.getElementById("bar2"),
  document.getElementById("bar3")
];
const zoomSlider = document.getElementById("zoomSlider");
const zoomVal = document.getElementById("zoomVal");
const okBtn = document.getElementById("okBtn");
const num = document.getElementById("num");

/* ================= BACKGROUND ================= */
bg.style.backgroundImage =
  "url(https://raw.githubusercontent.com/Hastin7008/buspass1/main/assets/bg1.jpg.jpg)";

/* ================= COLORS ================= */
function applyColors() {
  ring.style.borderColor = ringColor;
  bars.forEach((b,i)=>b.style.background = barColors[i]);
}
applyColors();

function setRingColor(c){ ringColor=c; applyColors(); }
function setBarColor(i,c){ barColors[i]=c; applyColors(); }

/* ================= ZOOM LOGIC ================= */
zoomSlider.oninput = e => {
  const scale = e.target.value / 100;
  zoomVal.textContent = e.target.value + "%";

  if (!locked) {
    uiScale = scale;
    ui.style.transform = `scale(${uiScale})`;
  } else {
    masterScale = scale;
    master.style.transform = `scale(${masterScale})`;
  }
};

okBtn.onclick = () => {
  locked = true;

  // Merge UI scale into master
  masterScale = uiScale;
  master.style.transform = `scale(${masterScale})`;

  // Reset UI scale
  uiScale = 1;
  ui.style.transform = "scale(1)";
};

/* ================= NUMBER ================= */
num.onclick = () => {
  numVal = (numVal + 1) % 10;
  num.textContent = numVal;
};
</script>

</body>
</html>
